(self.webpackChunkWebComponents=self.webpackChunkWebComponents||[]).push([[556],{78273:()=>{$.i18n().load({en:{msg_dragndrop_correct_answer:"You are correct!",msg_dragndrop_incorrect_answer:"Incorret. You got $1 correct and $2 incorrect out of $3. You left $4 blank.",msg_dragndrop_check_me:"Check me",msg_dragndrop_reset:"Reset"}})},26254:()=>{$.i18n().load({"pt-br":{msg_dragndrop_correct_answer:"Correto!",msg_dragndrop_incorrect_answer:"Incorreto. Você teve $1 correto(s) e $2 incorreto(s) de $3. Você deixou $4 em branco.",msg_dragndrop_check_me:"Verificar",msg_dragndrop_reset:"Resetar"}})},42556:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var i=r(2568),a=(r(78273),r(26254),{});class s extends i.Z{constructor(e){super(e);var t=e.orig;this.origElem=t,this.divid=t.id,this.useRunestoneServices=e.useRunestoneServices,this.random=!1,$(this.origElem).is("[data-random]")&&(this.random=!0),this.feedback="",this.dragPairArray=[],this.question="",this.populate(),this.createNewElements(),this.caption="Drag-N-Drop",this.addCaption("runestone")}populate(){for(var e=0;e<this.origElem.childNodes.length;e++)if("dropzone"===$(this.origElem.childNodes[e]).data("subcomponent")){var t=$(this.origElem).find(`#${$(this.origElem.childNodes[e]).attr("for")}`)[0],r=document.createElement("span");r.innerHTML=t.innerHTML,r.id=this.divid+t.id,$(r).attr("draggable","true"),$(r).addClass("draggable-drag");var i=document.createElement("span");i.innerHTML=this.origElem.childNodes[e].innerHTML,$(i).addClass("draggable-drop"),this.setEventListeners(r,i);var a=[];a.push(r),a.push(i),this.dragPairArray.push(a)}else"question"===$(this.origElem.childNodes[e]).data("subcomponent")?this.question=this.origElem.childNodes[e].innerHTML:"feedback"===$(this.origElem.childNodes[e]).data("subcomponent")&&(this.feedback=this.origElem.childNodes[e].innerHTML)}createNewElements(){this.containerDiv=document.createElement("div"),this.containerDiv.id=this.divid,$(this.containerDiv).addClass("draggable-container"),$(this.containerDiv).html(this.question),this.containerDiv.appendChild(document.createElement("br")),this.dragDropWrapDiv=document.createElement("div"),$(this.dragDropWrapDiv).css("display","block"),this.containerDiv.appendChild(this.dragDropWrapDiv),this.draggableDiv=document.createElement("div"),$(this.draggableDiv).addClass("rsdraggable dragzone"),this.addDragDivListeners(),this.dropZoneDiv=document.createElement("div"),$(this.dropZoneDiv).addClass("rsdraggable"),this.dragDropWrapDiv.appendChild(this.draggableDiv),this.dragDropWrapDiv.appendChild(this.dropZoneDiv),this.createButtons(),this.checkServer("dragNdrop",!0)}finishSettingUp(){this.appendReplacementSpans(),this.renderFeedbackDiv(),$(this.origElem).replaceWith(this.containerDiv),this.hasStoredDropzones||(this.minheight=$(this.draggableDiv).height()),this.draggableDiv.style.minHeight=this.minheight.toString()+"px",$(this.dropZoneDiv).height()>this.minheight?this.dragDropWrapDiv.style.minHeight=$(this.dropZoneDiv).height().toString()+"px":this.dragDropWrapDiv.style.minHeight=this.minheight.toString()+"px"}addDragDivListeners(){let e=this;this.draggableDiv.addEventListener("dragover",function(e){e.preventDefault(),$(this.draggableDiv).hasClass("possibleDrop")||$(this.draggableDiv).addClass("possibleDrop")}.bind(this)),this.draggableDiv.addEventListener("drop",function(t){e.isAnswered=!0,t.preventDefault(),$(this.draggableDiv).hasClass("possibleDrop")&&$(this.draggableDiv).removeClass("possibleDrop");var r=t.dataTransfer.getData("draggableID"),i=document.getElementById(r);$(this.draggableDiv).has(i).length||this.strangerDanger(i)||this.draggableDiv.appendChild(i)}.bind(this)),this.draggableDiv.addEventListener("dragleave",function(e){$(this.draggableDiv).hasClass("possibleDrop")&&$(this.draggableDiv).removeClass("possibleDrop")}.bind(this))}createButtons(){this.buttonDiv=document.createElement("div"),this.submitButton=document.createElement("button"),this.submitButton.textContent=$.i18n("msg_dragndrop_check_me"),$(this.submitButton).attr({class:"btn btn-success drag-button",name:"do answer",type:"button"}),this.submitButton.onclick=function(){this.checkCurrentAnswer(),this.renderFeedback(),this.logCurrentAnswer()}.bind(this),this.resetButton=document.createElement("button"),this.resetButton.textContent=$.i18n("msg_dragndrop_reset"),$(this.resetButton).attr({class:"btn btn-default drag-button drag-reset",name:"do answer"}),this.resetButton.onclick=function(){this.resetDraggables()}.bind(this),this.buttonDiv.appendChild(this.submitButton),this.buttonDiv.appendChild(this.resetButton),this.containerDiv.appendChild(this.buttonDiv)}appendReplacementSpans(){this.createIndexArray(),this.randomizeIndexArray();for(let e=0;e<this.dragPairArray.length;e++)this.hasStoredDropzones?$.inArray(this.indexArray[e][0],this.pregnantIndexArray)<0&&this.draggableDiv.appendChild(this.dragPairArray[this.indexArray[e]][0]):this.draggableDiv.appendChild(this.dragPairArray[this.indexArray[e]][0]);this.randomizeIndexArray();for(let e=0;e<this.dragPairArray.length;e++)this.hasStoredDropzones&&"-1"!==this.pregnantIndexArray[this.indexArray[e]]&&this.dragPairArray[this.indexArray[e]][1].appendChild(this.dragPairArray[this.pregnantIndexArray[this.indexArray[e]]][0]),this.dropZoneDiv.appendChild(this.dragPairArray[this.indexArray[e]][1])}setEventListeners(e,t){let r=this;e.addEventListener("dragstart",(function(e){e.dataTransfer.setData("draggableID",e.target.id)})),e.addEventListener("dragover",(function(e){e.preventDefault()})),e.addEventListener("drop",function(e){r.isAnswered=!0,e.preventDefault();var t=e.dataTransfer.getData("draggableID"),i=document.getElementById(t);this.hasNoDragChild(e.target)&&i!=e.target&&!this.strangerDanger(i)&&this.draggableDiv.appendChild(i)}.bind(this)),t.addEventListener("dragover",function(e){r.isAnswered=!0,e.preventDefault(),$(e.target).hasClass("possibleDrop")||$(e.target).hasClass("draggable-drop")&&this.hasNoDragChild(e.target)&&$(e.target).addClass("possibleDrop")}.bind(this)),t.addEventListener("dragleave",(function(e){r.isAnswered=!0,e.preventDefault(),$(e.target).hasClass("possibleDrop")&&$(e.target).removeClass("possibleDrop")})),t.addEventListener("drop",function(e){r.isAnswered=!0,e.preventDefault(),$(e.target).hasClass("possibleDrop")&&$(e.target).removeClass("possibleDrop");var t=e.dataTransfer.getData("draggableID"),i=document.getElementById(t);$(e.target).hasClass("draggable-drop")&&this.hasNoDragChild(e.target)&&!this.strangerDanger(i)&&e.target.appendChild(i)}.bind(this))}renderFeedbackDiv(){this.feedBackDiv||(this.feedBackDiv=document.createElement("div"),this.feedBackDiv.id=this.divid+"_feedback",this.containerDiv.appendChild(document.createElement("br")),this.containerDiv.appendChild(this.feedBackDiv))}strangerDanger(e){for(var t=!0,r=0;r<this.dragPairArray.length;r++)e===this.dragPairArray[r][0]&&(t=!1);return t}hasNoDragChild(e){for(var t=0,r=0;r<e.childNodes.length;r++)"true"===$(e.childNodes[r]).attr("draggable")&&t++;return!(t>=1)}createIndexArray(){this.indexArray=[];for(var e=0;e<this.dragPairArray.length;e++)this.indexArray.push(e)}randomizeIndexArray(){for(var e,t,r=this.indexArray.length;0!==r;)t=Math.floor(Math.random()*r),r-=1,e=this.indexArray[r],this.indexArray[r]=this.indexArray[t],this.indexArray[t]=e}resetDraggables(){for(var e=0;e<this.dragPairArray.length;e++)for(var t=0;t<this.dragPairArray[e][1].childNodes.length;t++)"true"===$(this.dragPairArray[e][1].childNodes[t]).attr("draggable")&&this.draggableDiv.appendChild(this.dragPairArray[e][1].childNodes[t]);this.feedBackDiv.style.display="none"}checkCurrentAnswer(){this.correct=!0,this.unansweredNum=0,this.incorrectNum=0,this.dragNum=this.dragPairArray.length;for(var e=0;e<this.dragPairArray.length;e++)$(this.dragPairArray[e][1]).has(this.dragPairArray[e][0]).length||(this.correct=!1,this.incorrectNum++),this.hasNoDragChild(this.dragPairArray[e][1])&&(this.unansweredNum++,this.incorrectNum-=1);this.correctNum=this.dragNum-this.incorrectNum-this.unansweredNum,this.percent=this.correctNum/this.dragPairArray.length,this.setLocalStorage({correct:this.correct?"T":"F"})}async logCurrentAnswer(e){let t=this.pregnantIndexArray.join(";"),r={event:"dragNdrop",act:t,answer:t,min_height:this.minheight,div_id:this.divid,correct:this.correct,correctNum:this.correctNum,dragNum:this.dragNum};void 0!==e&&(r.sid=e),await this.logBookEvent(r)}renderFeedback(){for(var e=0;e<this.dragPairArray.length;e++)$(this.dragPairArray[e][1]).has(this.dragPairArray[e][0]).length?$(this.dragPairArray[e][1]).removeClass("drop-incorrect"):$(this.dragPairArray[e][1]).addClass("drop-incorrect");if(this.feedBackDiv||this.renderFeedbackDiv(),this.feedBackDiv.style.display="block",this.correct){var t=$.i18n("msg_dragndrop_correct_answer");$(this.feedBackDiv).html(t),$(this.feedBackDiv).attr("class","alert alert-info draggable-feedback")}else{var r=$.i18n($.i18n("msg_dragndrop_incorrect_answer"),this.correctNum,this.incorrectNum,this.dragNum,this.unansweredNum);$(this.feedBackDiv).html(r+" "+this.feedback),$(this.feedBackDiv).attr("class","alert alert-danger draggable-feedback")}}restoreAnswers(e){this.hasStoredDropzones=!0,this.minheight=e.min_height,this.pregnantIndexArray=e.answer.split(";"),this.finishSettingUp()}checkLocalStorage(){if(!this.graderactive){var e;if(this.hasStoredDropzones=!1,localStorage.length>0){var t=localStorage.getItem(this.localStorageKey());if(null!==t){this.hasStoredDropzones=!0;try{e=JSON.parse(t),this.minheight=e.min_height}catch(e){return console.log(e.message),localStorage.removeItem(this.localStorageKey()),this.hasStoredDropzones=!1,void this.finishSettingUp()}if(this.pregnantIndexArray=e.answer.split(";"),this.useRunestoneServices){var r=this.pregnantIndexArray.join(";");this.logBookEvent({event:"dragNdrop",act:r,answer:r,min_height:this.minheight,div_id:this.divid,correct:e.correct})}}}this.finishSettingUp()}}setLocalStorage(e){if(void 0===e.answer){this.pregnantIndexArray=[];for(var t=0;t<this.dragPairArray.length;t++)if(this.hasNoDragChild(this.dragPairArray[t][1]))this.pregnantIndexArray.push(-1);else for(var r=0;r<this.dragPairArray.length;r++)$(this.dragPairArray[t][1]).has(this.dragPairArray[r][0]).length&&this.pregnantIndexArray.push(r)}var i=new Date,a=e.correct,s={answer:this.pregnantIndexArray.join(";"),min_height:this.minheight,timestamp:i,correct:a};localStorage.setItem(this.localStorageKey(),JSON.stringify(s))}disableInteraction(){$(this.resetButton).hide();for(var e=0;e<this.dragPairArray.length;e++)$(this.dragPairArray[e][0]).attr("draggable","false"),$(this.dragPairArray[e][0]).css("cursor","initial")}}$(document).on("runestone:login-complete",(function(){$("[data-component=dragndrop]").each((function(e){var t={orig:this,useRunestoneServices:eBookConfig.useRunestoneServices};if(0==$(this).closest("[data-component=timedAssessment]").length)try{a[this.id]=new s(t)}catch(e){console.log(`Error rendering DragNDrop Problem ${this.id}`)}}))}));class n extends s{constructor(e){super(e),this.finishSettingUp(),this.renderTimedIcon(this.containerDiv),this.hideButtons()}hideButtons(){$(this.submitButton).hide()}renderTimedIcon(e){var t=document.createElement("div"),r=document.createElement("img");$(r).attr({src:"../_static/clock.png",style:"width:15px;height:15px"}),t.className="timeTip",t.title="",t.appendChild(r),$(e).prepend(t)}checkCorrectTimed(){switch(this.unansweredNum===this.dragPairArray.length&&(this.correct=null),this.correct){case!0:return"T";case!1:return"F";default:return null}}hideFeedback(){$(this.feedBackDiv).hide()}}void 0===window.component_factory&&(window.component_factory={}),window.component_factory.dragndrop=function(e){return e.timed?new n(e):new s(e)}}}]);
//# sourceMappingURL=556.77bfa84fe6f8f1b0.bundle.js.map